@page "/article/read/{Id}"

@if (_loading || _article == null)
{
    <ArticleDetailSkeleton />
}
else
{
    <PageTitle>@_article.Title - 个人文章分享</PageTitle>
    <div class="container article-container">

        <div class="article-layout">
            <article class="article-read shadow-lg">
                <header class="article-header">
                    <h1 class="article-title">
                       @_article.Title
                    </h1>

                    @if (_article.AdWeight >= 0.7)
                    {
                        <div class="alert alert--warning mb-1">
                            <i class="fa fa-warning"></i> AI分析结果显示本文可能包含广告，请注意甄别
                        </div>
                    }

                    <div class="article-meta">
                        <span class="article-meta__item" title="发布时间">
                            <i class="fa fa-calendar"></i>
                            <ShowDateTime DateTime="_article.CreateTime"></ShowDateTime>
                        </span>
                        <span class="article-meta__item">
                            <i class="fa fa-user"></i> @_article.Author.Name
                        </span>
                        <span class="article-meta__item">
                            <i class="fa fa-eye"></i> @_article.ViewCount 阅读
                        </span>
                        <span class="article-meta__item">
                            <i class="fa-solid fa-comment-dots"></i> @_article.CommentCount 评论
                        </span>
                    </div>
                </header>

                <div class="article-content markdown-body">
                    @if (!string.IsNullOrEmpty(_article.Introduction))
                    {
                        <div class="article-intro">
                            @((MarkupString)_article.Introduction)
                        </div>
                    }

                    <MarkdownPreview Markdown="@_article?.Markdown"></MarkdownPreview>
                </div>

                <footer class="article-footer mt-2">
                    <div class="article-tags">
                        <i class="fa fa-tags text-muted mr-1"></i>
                        @foreach (var tag in _article.Tags)
                        {
                            <a href="/article/list/tag/@tag" class="article__tag" data-pjax>@tag</a>
                        }
                    </div>
                    <div class="article-copyright mt-2">
                        <p>版权声明：本站文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</p>
                    </div>
                </footer>
            </article>

            <!-- Table of Contents Container -->
            <nav class="js-toc toc"></nav>

            <!-- Mobile TOC Controls -->
            <button class="toc-fab js-toc-fab" aria-label="Toggle Table of Contents">
                <i class="fa fa-list-ul"></i>
            </button>
        </div>

        <!-- Comments -->
        <div class="mt-2">
            @* TODO *@
            @* <partial name="_GlobalCommentPartial" model="(CommentNode.Article,Model.Id)"/> *@
            <Comment Node="CommentNode.Article" Relation="@_article.Id"></Comment>
        </div>
    </div>
}