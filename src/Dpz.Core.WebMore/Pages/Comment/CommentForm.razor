<EditForm class="@($"comment-form {(!string.IsNullOrEmpty(ReplyId) ? "comment-form--reply" : "")}")" autocomplete="off" OnValidSubmit="SendAsync" Model="_model">
    <DataAnnotationsValidator />
    <div class="comment-form__header">
        <div class="comment-form__group">
            <label class="comment-form__label">昵称<span>*</span></label>
            <input name="nickname" autocomplete="off" class="comment-form__input" required @bind="@_model.NickName"/>
        </div>
        <div class="comment-form__group">
            <label class="comment-form__label">邮箱<span>*</span></label>
            <input name="email" type="email" autocomplete="off" class="comment-form__input" required @bind="@_model.Email"/>
        </div>
        <div class="comment-form__group">
            <label class="comment-form__label">个人网站</label>
            <input name="site" type="url" autocomplete="off" class="comment-form__input" @bind="@_model.Site"/>
        </div>
    </div>
    
    <div class="comment-form__editor-wrapper">
        <textarea @bind="@_model.CommentText" required class="comment-form__editor"
                    placeholder="使用严格模式Markdown渲染，如与你预期不同，请查看Markdown文档" 
                    name="commentText" 
                    maxlength="1000">
        </textarea>
    </div>

    <div class="comment-form__footer">
        <div class="comment-form__actions">
            <a href="https://spec.commonmark.org/" title="CommonMark 规范" class="comment-form__action-btn" target="_blank">
                <svg width="16" height="16" ariaHidden="true" viewBox="0 0 16 16">
                    <path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path>
                </svg>
            </a>
            <button type="button" class="comment-form__action-btn" title="添加图片&#10;只提供网络图片&#10;不提供上传" @onclick="ShowPicture">
                <svg viewBox="0 0 1024 1024" width="20" height="20">
                    <path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path>
                </svg>
            </button>
        </div>
        <div class="comment-form__submit-actions">
            @if (!string.IsNullOrEmpty(ReplyId))
            {
                <button type="button" class="comment-form__cancel-btn" @onclick="OnCancelReply">取消回复</button>
            }
            <button type="submit" class="comment-form__submit-btn" disabled="@_isSending">
                @if (_isSending)
                {
                    <svg class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px"><path d="M21 12a9 9 0 11-6.219-8.56"></path></svg>
                    <span>正在发送</span>
                }
                else
                {
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22,2 15,22 11,13 2,9 22,2"></polygon></svg>
                    <span>发送</span>
                }
            </button>
        </div>
    </div>
    <input type="hidden" @bind="@_model.Relation" name="relation"/>
    <input type="hidden" @bind="@_model.Node" name="node"/>
    <input type="hidden" @bind="@_model.ReplyId" name="replyId"/>
</EditForm>
